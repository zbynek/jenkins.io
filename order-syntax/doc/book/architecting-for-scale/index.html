<!DOCTYPE html>
<html lang="en">
<head>
<title>
Architecting for Scale
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Architecting for Scale" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Architecting for Scale" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="https://zbynek.github.io/jenkins.io/order-syntax/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Architecting for Scale" property="og:title">
<meta content="article" property="og:type">
<meta content="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/architecting-for-scale/index.html" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Architecting for Scale" property="og:site_name">
<meta content="https://zbynek.github.io/jenkins.io/order-syntax/images/logo-title-opengraph.png" name="og:image">
<link href="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/tether/css/tether.min.css" media="screen" rel="stylesheet">
<link href="https://zbynek.github.io/jenkins.io/order-syntax/css/font-icons.css" media="screen" rel="stylesheet">
<link href="https://zbynek.github.io/jenkins.io/order-syntax/css/jenkins.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/ionicons/css/ionicons.min.css" media="screen" rel="stylesheet">
<link href="https://zbynek.github.io/jenkins.io/order-syntax/css/footer.css" media="screen" rel="stylesheet">
<link href="https://zbynek.github.io/jenkins.io/order-syntax/css/font-awesome.min.css" media="screen" rel="stylesheet">
</head>
<body>
<script src="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<nav class="navbar navbar-expand-lg navbar-dark top bg-dark fixed-top" id="ji-toolbar">
<a class="navbar-brand" href="https://zbynek.github.io/jenkins.io/order-syntax">
Jenkins
</a>
<button class="navbar-toggler" data-target="#CollapsingNavbar" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="CollapsingNavbar">
<ul class="nav navbar-nav mr-auto">
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
<!-- starting partial cdf_logo.html.haml -->
<svg width="36" height="18" xmlns="http://www.w3.org/2000/svg" role="img" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-3.23 44.77 362.70 271.95"><defs><linearGradient id="a" x1="359.765" x2="104.082" y1="134.295" y2="124.577" gradientTransform="matrix(1 0 0 -1 0 439.068)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#ed1c24"/><stop offset="1" stop-color="#f7941d"/></linearGradient><linearGradient id="b" x1="355.202" x2="99.519" y1="254.467" y2="244.749" xlink:href="#a"/><linearGradient id="c" x1="183.903" x2="10.612" y1="227.598" y2="221.023" xlink:href="#a"/><linearGradient id="d" x1="367.119" x2="157.995" y1="265.311" y2="257.091" xlink:href="#a"/></defs><path fill="#c49a6c" d="M231.52 309.278c2.483-.332 4.895-.77 7.255-1.329s4.649-1.206 6.991-1.957c13.494-4.58 25.187-12.952 36.374-24.593l-.14-.175c-14.944 15.486-30.693 25.344-50.48 28.054z"/><path fill="url(#a)" d="M224.232 309.96h.332c1.084 0 2.15-.14 3.216-.228a93.844 93.844 0 0 1-3.233.227z"/><path fill="url(#b)" d="M284.692 187.187l-.122.192.122-.192z"/><path fill="url(#c)" d="M146.145 231.847a150.844 150.844 0 0 1-12.97 15.862c-7.582 7.889-15.507 13.563-24.652 16.667a47.832 47.832 0 0 1-4.738 1.326 56.959 56.959 0 0 1-4.916.9 38.32 38.32 0 0 1-1.682.214l-.912.083c-.723.059-1.445.118-2.18.154h-3.068a42.325 42.325 0 0 1-9.192-1.043 49.977 49.977 0 0 1-6.764-2.002 43.097 43.097 0 0 1-4.525-1.954c-1.493-.77-2.961-1.516-4.407-2.37a59.5 59.5 0 0 1-17.105-15.399 59.714 59.714 0 0 1-2.914-4.311 53.09 53.09 0 0 1-1.291-2.263 51.985 51.985 0 0 1-2.263-4.738 46.72 46.72 0 0 1 0-36.426 51.986 51.986 0 0 1 2.263-4.738 54.14 54.14 0 0 1 1.291-2.263 59.742 59.742 0 0 1 2.914-4.311 59.714 59.714 0 0 1 17.105-15.4 60.828 60.828 0 0 1 4.407-2.369q2.217-1 4.525-1.777a49.976 49.976 0 0 1 6.906-2.073 42.325 42.325 0 0 1 9.192-1.042h3.128c.722 0 1.445.094 2.155.154l1.043.106 1.019.119c1.8.237 3.553.557 5.271.96.853.2 1.694.426 2.523.663a51.186 51.186 0 0 1 11.846 5.176 59.645 59.645 0 0 1 4.395 2.89 74.485 74.485 0 0 1 8.386 7.108q2.038 1.99 4.063 4.193l.083-.13a159.395 159.395 0 0 1 11.064 13.942c5.437-8.576 13.658-21.464 16.584-25.74 1.185-1.718 2.37-3.46 3.66-5.212-13.54-16.513-29.827-30.23-51.587-36.082h-.154a89.397 89.397 0 0 0-3.187-.794l-.45-.107a92.565 92.565 0 0 0-3.151-.627l-.628-.119a80.578 80.578 0 0 0-3.743-.569h-.142a58.29 58.29 0 0 0-2.073-.236h-.391l-1.872-.166h-.568l-1.754-.119h-.675l-1.777-.07h-3.115c-46.447-.25-87.125 40.476-87.125 86.911s40.725 87.173 87.172 87.173h3.14l1.729-.071h.734l1.67-.095h.676l1.706-.154h.568l1.813-.213.414-.06 1.967-.272h.213a125.91 125.91 0 0 0 3.553-.628l.652-.142c.96-.201 1.907-.415 2.855-.64l.58-.142a86.66 86.66 0 0 0 3.009-.817l.237-.071c20.73-6.077 36.425-19.392 49.55-35.277-2.037-3.068-3.4-5.366-4.039-6.48z"/><path fill="url(#d)" d="M318.05 51.733v94.66a85.514 85.514 0 0 0-52.595-18.729h-3.115l-1.777.072-.7.047-1.752.118h-.569l-1.871.166h-.391c-.7.071-1.386.142-2.073.237h-.154c-1.256.154-2.5.355-3.732.569l-.628.118c-1.066.19-2.108.403-3.15.628l-.45.107c-30.35 6.858-50.333 28.808-66.822 52.82-.7 1.018-1.35 2.049-2.038 3.068-2.25 3.423-5.46 8.422-8.635 13.397-4.17 6.527-8.292 13.03-9.939 15.66l20.624 32.137s21.997 40.465 61.68 51.482l.237.07c.995.297 2.002.558 3.009.818l.58.142c.936.237 1.896.439 2.855.64l.652.142c1.184.225 2.369.439 3.553.628h.214l1.966.273.415.059 1.812.213h.569l1.705.154h.676l1.67.095h.734l1.73.07h3.139c54.703 0 86.355-30.964 87.149-85.063V51.733zm-52.595 215.403h-3.068c-.734 0-1.457-.095-2.18-.154l-.912-.083c-.568-.06-1.125-.13-1.682-.213a49.077 49.077 0 0 1-9.571-2.275 49.612 49.612 0 0 1-6.634-2.83 55.792 55.792 0 0 1-6.254-3.768 63.068 63.068 0 0 1-3.009-2.215 82.399 82.399 0 0 1-8.683-7.925l-.095.119c-1.255-1.303-2.487-2.69-3.731-4.11-.154-.167-.296-.356-.45-.534-.628-.722-1.256-1.445-1.884-2.215s-1.125-1.398-1.682-2.097-.888-1.101-1.338-1.682a184.467 184.467 0 0 1-6.053-8.292c-.7-.995-1.398-2.025-2.109-3.056-.379-.569-.77-1.184-1.185-1.73-.675-1.018-1.362-2.013-2.049-3.056l-.355-.545c-1.185-1.812-2.37-3.684-3.649-5.603q2.95-4.608 5.817-8.86c1.907-2.831 3.79-5.556 5.662-8.138s3.72-5.046 5.591-7.38 3.72-4.525 5.603-6.586q2.026-2.203 4.063-4.194c1.374-1.338 2.748-2.594 4.158-3.778s2.807-2.287 4.252-3.329a57.594 57.594 0 0 1 7.748-4.62c.331-.166.663-.367 1.006-.533l.226-.118c1.41-.652 2.843-1.185 4.3-1.73l.485-.201c.273-.083.557-.142.83-.237a44.943 44.943 0 0 1 3.34-.948l1.374-.343a60.798 60.798 0 0 1 4.738-.841l1.019-.119 1.042-.106c.711 0 1.434-.119 2.156-.154h3.128a42.431 42.431 0 0 1 4.572.26 48.011 48.011 0 0 1 6.93 1.35c1.54.427 3.08.925 4.596 1.505a48.724 48.724 0 0 1 4.525 1.955c1.493.722 2.961 1.516 4.407 2.369s2.866 1.8 4.24 2.784 2.725 2.049 4.028 3.174a58.459 58.459 0 0 1 8.837 9.477 59.73 59.73 0 0 1 2.914 4.312 51.067 51.067 0 0 1 5.318 11.916 47.38 47.38 0 0 1 1.185 5.165 45.567 45.567 0 0 1 .71 8.09c.072 35.964-16.062 52.122-52.227 52.122z"/></svg>

<!-- ending partial cdf_logo.html.haml -->
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item feature" href="https://cd.foundation/">
What is CDF?
</a>
<a class="dropdown-item feature" href="https://jenkins-x.io/">
Jenkins X
</a>
<a class="dropdown-item feature" href="https://cloud.google.com/tekton/">
Tekton
</a>
<a class="dropdown-item feature" href="https://www.spinnaker.io/">
Spinnaker
</a>
</div>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" href="https://zbynek.github.io/jenkins.io/order-syntax/node">
Blog
</a>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
Documentation
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/doc">
Use Jenkins
</a>
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/doc/developer">
Extend Jenkins
</a>
<span class="dropdown-item">
<strong>
Use-cases
</strong>
</span>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/android">
&nbsp;-&nbsp;Android
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/c">
&nbsp;-&nbsp;C/C++
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/docker">
&nbsp;-&nbsp;Docker
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/embedded">
&nbsp;-&nbsp;Embedded
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/github">
&nbsp;-&nbsp;GitHub
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/java">
&nbsp;-&nbsp;Java
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/php">
&nbsp;-&nbsp;PHP
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/pipeline">
&nbsp;-&nbsp;Continuous Delivery
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/python">
&nbsp;-&nbsp;Python
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/solutions/ruby">
&nbsp;-&nbsp;Ruby
</a>
</div>
</li>
<li class="nav-item">
<a class="nav-link" href="https://plugins.jenkins.io/">
Plugins
</a>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
Community
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/participate">
Overview
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/chat" title="Chat with the rest of the Jenkins community on IRC">
Chat
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/jam">
Meet
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/events">
Events
</a>
<a class="dropdown-item feature" href="https://issues.jenkins-ci.org/">
Issue Tracker
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/mailing-lists" title="Browse Jenkins mailing list archives and/or subscribe to lists">
Mailing Lists
</a>
<a class="dropdown-item feature" href="https://wiki.jenkins.io/">
Wiki
</a>
<a class="dropdown-item feature" href="https://accounts.jenkins.io/" title="Create/manage your account for accessing wiki, issue tracker, etc">
Account Management
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/">
<strong>
Special Interest Groups
</strong>
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/advocacy-and-outreach/">
&nbsp;-&nbsp;Advocacy and Outreach
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/chinese-localization/">
&nbsp;-&nbsp;Chinese Localization
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/cloud-native/">
&nbsp;-&nbsp;Cloud Native
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/docs/">
&nbsp;-&nbsp;Documentation
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/gsoc/">
&nbsp;-&nbsp;Google Summer of Code
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/hw-and-eda/">
&nbsp;-&nbsp;Hardware and EDA
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/pipeline-authoring/">
&nbsp;-&nbsp;Pipeline Authoring
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/sigs/platform/">
&nbsp;-&nbsp;Platform
</a>
</div>
</li>
<li class="dropdown nav-item">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
Subprojects
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/">
Overview
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/blueocean/">
Blue Ocean
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/evergreen/">
Evergreen
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/gsoc/">
Google Summer of Code in Jenkins
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/infrastructure/">
Infrastructure
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/jam/">
Jenkins Area Meetups
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/jcasc/">
Jenkins Configuration as Code
</a>
<a class="dropdown-item feature" href="https://zbynek.github.io/jenkins.io/order-syntax/projects/remoting/">
Jenkins Remoting
</a>
</div>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
About
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/security">
Security
</a>
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/press">
Press
</a>
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/awards">
Awards
</a>
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/project/conduct">
Conduct
</a>
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/artwork">
Artwork
</a>
</div>
</li>
<li class="nav-item dropdown">
<!-- starting partial dropdown.html.haml -->
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown">
English
</button>

<!-- ending partial dropdown.html.haml -->
<div class="dropdown-menu">
<a class="dropdown-item" href="https://zbynek.github.io/jenkins.io/order-syntax/zh">
中文 Chinese
</a>
</div>
</li>
<li class="nav-item">
<a class="nav-link btn btn-outline-secondary" href="https://zbynek.github.io/jenkins.io/order-syntax/download">
Download
</a>
</li>
</ul>
</div>
</nav>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<script>
  $(function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>
<div class="container">
<div class="row body">
<div class="col-lg-3">
<div class="sidebar-nav tour">
<p>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc" class="">Jenkins User Documentation Home</a>
</p>
<h4>
Guided Tour
</h4>
<ul>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/getting-started" class="">Getting started</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/hello-world" class="">Creating your first Pipeline</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/running-multiple-steps" class="">Running multiple steps</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/agents" class="">Defining execution environments</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/environment" class="">Using environment variables</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/tests-and-artifacts" class="">Recording test results and artifacts</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/post" class="">Cleaning up and notifications</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/tour/deployment" class="">Deployment</a>
</li>
</ul>
<h4>
Tutorials
</h4>
<ul>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials" class="">Overview</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials/build-a-java-app-with-maven" class="">Build a Java app with Maven</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials/build-a-node-js-and-react-app-with-npm" class="">Build a Node.js and React app with npm</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials/build-a-python-app-with-pyinstaller" class="">Build a Python app with PyInstaller</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials/build-a-labview-app" class="">Build a LabVIEW app</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials/create-a-pipeline-in-blue-ocean" class="">Create a Pipeline in Blue Ocean</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/tutorials/build-a-multibranch-pipeline-project" class="">End-to-End Multibranch Pipeline Project Creation</a>
</li>
</ul>
<ul>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/getting-started" class="">User Handbook overview</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/installing" class="">Installing Jenkins</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/using" class="">Using Jenkins</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/pipeline" class="">Pipeline</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/blueocean" class="">Blue Ocean</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/managing" class="">Managing Jenkins</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/system-administration" class="">System Administration</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/scaling" class="">Scaling Jenkins</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/appendix" class="">Appendix</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/glossary" class="">Glossary</a>
</li>
</ul>
<h4>
Resources
</h4>
<ul>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/book/pipeline/syntax" class="">Pipeline Syntax reference</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/pipeline/steps" class="">Pipeline Steps reference</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc/upgrade-guide" class="">LTS Upgrade Guide</a>
</li>
</ul>
<h5>
Recent Tutorial Blog Posts
</h5>
<ul>
<li>
<a href="/blog/2017/11/27/tutorials-in-the-jenkins-user-documentation/">
Introducing Tutorials in the Jenkins User Documentation
</a>
</li>
<li>
<a href="/blog/2017/05/18/pipeline-dev-tools/">
Pipeline Development Tools
</a>
</li>
<li>
<a href="/blog/2017/04/12/welcome-to-blue-ocean-dashboard/">
Getting Started with the Blue Ocean Dashboard
</a>
</li>
</ul>
<div class="small">
<a href="/node/tags/tutorial">
View all tutorial blog posts
</a>
</div>
<p></p>
</div>
</div>
<div class="col-lg-9">
<h1>
Architecting for Scale
</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#architecting-for-scale">Architecting for Scale</a>
<ul class="sectlevel2">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#distributed-builds-architecture">Distributed Builds Architecture</a></li>
<li><a href="#creating-fungible-slaves">Creating fungible slaves</a></li>
<li><a href="#right-sizing-jenkins-masters">Right-sizing Jenkins masters</a></li>
<li><a href="#setting-up-a-backup-policy">Setting up a backup policy</a></li>
<li><a href="#resilient-jenkins-architecture">Resilient Jenkins Architecture</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="architecting-for-scale"><a class="anchor" href="#architecting-for-scale"></a>Architecting for Scale</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h3>
<div class="paragraph">
<p>As an organization matures from a continuous delivery standpoint, its Jenkins
requirements will similarly grow. This growth is often reflected in the Jenkins
master&#8217;s architecture, whether that be "vertical" or "horizontal" growth.</p>
</div>
<div class="paragraph">
<p><strong>Vertical growth</strong> is when a master&#8217;s load is increased by having more
configured jobs or orchestrating more frequent builds. This may also mean that
more teams are depending on that one master.</p>
</div>
<div class="paragraph">
<p><strong>Horizontal</strong> growth is the creation of additional masters within an
organization to accommodate new teams or projects, rather than adding these
things to an existing single master.</p>
</div>
<div class="paragraph">
<p>There are potential pitfalls associated with each approach to scaling Jenkins,
but with careful planning, many of them can be avoided or managed. Here are
some things to consider when choosing a strategy for scaling your
organization&#8217;s Jenkins instances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Do you have the resources to run a distributed build system?</strong> If possible,
it is recommended set up dedicated build nodes that run separately from the
Jenkins master. This frees up resources for the master to improve its
scheduling performance and prevents builds from being able to modify any
potentially sensitive data in the master&#8217;s <em>$JENKINS_HOME</em>. This also allows
for a single master to scale far more vertically than if that master were
both the job builder and scheduler.</p>
</li>
<li>
<p><strong>Do you have the resources to maintain multiple masters?</strong> Jenkins masters
will require regular plugin updates, semi-monthly core upgrades, and regular
backups of configurations and build histories. Security settings and roles
will have to be manually configured for each master. Downed masters will
require manual restart of the Jenkins master and any jobs that were killed by
the outage.</p>
</li>
<li>
<p><strong>How mission critical are each team&#8217;s projects?</strong> Consider segregating the
most vital projects to separate masters to minimize the impact of a single
downed master. Also consider converting any mission-critical project
pipelines to Pipeline jobs, which have the ability to survive a master-agent
connection interruptions.</p>
</li>
<li>
<p><strong>How important is a fast start-up time for your Jenkins instance?</strong> The more
jobs a master has configured, the longer it takes to load Jenkins after an
upgrade or a crash. The use of folders and views to organize jobs can limit
the number of that need to be rendered on start up.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="distributed-builds-architecture"><a class="anchor" href="#distributed-builds-architecture"></a>Distributed Builds Architecture</h3>
<div class="paragraph">
<p>A Jenkins master can operate by itself both managing the build environment and
executing the builds with its own executors and resources. If you stick with
this "standalone" configuration you will most likely run out of resources when
the number or the load of your projects increase.</p>
</div>
<div class="paragraph">
<p>To come back up and running with your Jenkins infrastructure you will need to
enhance the master (increasing memory, number of CPUs, etc). The time it takes
to maintain and upgrade the machine, the master together with all the build
environment will be down, the jobs will be stopped and the whole Jenkins
infrastructure will be unusable.</p>
</div>
<div class="paragraph">
<p>Scaling Jenkins in such a scenario would be extremely painful and would
introduce many "idle" periods where all the resources assigned to your build
environment are useless.</p>
</div>
<div class="paragraph">
<p>Moreover, executing jobs on the master&#8217;s executors introduces a "security"
issue: the "jenkins" user that Jenkins uses to run the jobs would have full
permissions on all Jenkins resources on the master. This means that, with a
simple script, a malicious user can have direct access to private information
whose integrity and privacy could not be, thus,  guaranteed.</p>
</div>
<div class="paragraph">
<p>For all these reasons Jenkins supports the "master/agent" mode, where the
workload of building projects are delegated to multiple agents.</p>
</div>
<div class="paragraph">
<p>An agent is a machine set up to offload projects from the master. The method
with which builds are scheduled depends on the configuration given to each
project. For example, some projects may be configured to "restrict where this
project is run" which ties the project to a specific agent or set of labeled
agents. Other projects which omit this configuration will select an agent from
the available pool in Jenkins.</p>
</div>
<div class="paragraph">
<p>In a distributed builds environment, the Jenkins master will use its resources
to only handle HTTP requests and manage the build environment. Actual execution
of builds will be delegated to the agents. With this configuration it is
possible to horizontally scale an architecture, which allows a single Jenkins
installation to host a large number of projects and build environments.</p>
</div>
<div class="sect3">
<h4 id="masteragent-communication-protocols"><a class="anchor" href="#masteragent-communication-protocols"></a>Master/agent communication protocols</h4>
<div class="paragraph">
<p>In order for a machine to be recognized an agent, it needs to run a specific
agent program to establish bi-directional communication with the master.</p>
</div>
<div class="paragraph">
<p>There are different ways to establish a connection between master and agent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The SSH connector</strong>: Configuring an agent to use the SSH connector is the
preferred and the most stable way to establish master-agent communication.
Jenkins has a built-in SSH client implementation. This means that the
Jenkins master can easily communicate with any machine with an SSH server
installed. The only requirement is that the public key of the master is
part of the set of the authorized keys on the agent. Once the host and SSH key
is defined for a new agent, Jenkins will establish a connection to
the machine and bootstrap the agent process.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The JNLP-TCP connector</strong>: In this case the communication is established
starting the agent through Java Web Start (JNLP). With this connector
the Java Web Start program has to be launched in the machine in 2
different ways:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Manually: by navigating to the Jenkins master URL in a browser on the agent.
Once the Java Web Start icon is clicked, the agent will be launched on the
machine. The downside of this approach is that the agents cannot be centrally
managed by the Jenkins master and each/stop/start/update of the agent needs to
be executed manually on the agent&#8217;s machine in versions of Jenkins older than
1.611. This approach is convenient when the master cannot instantiate the
connection with the client, for example: with agents running inside a
firewalled network connecting to a master located outside the firewall.</p>
</li>
<li>
<p>As a service: First you&#8217;ll need to manually launch the agent using the above
method. After manually launching it, <em>jenkins-slave.exe</em> and
<em>jenkins-slave.xml</em> will be created in the slave&#8217;s work directory. Now go to
the command line to execute the following command:</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>sc.exe create "&lt;serviceKey&gt;" start= auto binPath= "&lt;path to jenkins-slave.exe&gt;" DisplayName= "&lt;service display name&gt;"</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>&lt;serviceKey&gt;</em> is the name of the registry key to define this agent service and
&lt;service display name&gt; is the label that will identify the service in the
Service Manager interface.</p>
</div>
<div class="paragraph">
<p>To ensure that restarts are automated, you will need to download a agent jar
newer than v 2.37 and copy it to a permanent location on the machine. The
<em>.jar</em> file can be found at:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>http://&lt;your-jenkins-host&gt;/jnlpJars/slave.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>If running a version of Jenkins newer than 1.559, the <em>.jar</em> will be kept
up to date each time it connects to the master.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The JNLP-HTTP connector</strong>: This approach is quite similar to the JNLP-TCP
Java Web Start approach, with the difference in this case being that the
agent is executed as headless and the connection can be tunneled via HTTP(s).
The exact command can be found on your JNLP gaent&#8217;s configuration page:</p>
</li>
</ul>
</div>
<div id="jnlp_agent" class="imageblock">
<div class="content">
<img src="/doc/book/resources/hardware-recommendations/jnlp-slave.png" alt="jnlp slave">
</div>
<div class="title">Figure 1. JNLP agent launch command</div>
</div>
<div class="paragraph">
<p>This approach is convenient for an execution as a daemon on Unix.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Custom-script</strong>: It is also possible to create a custom script to initialize
the communication between master and agent if the other solutions do not
provide enough flexibility for a specific use-case. The only requirement is
that the script runs the java program as a <em>java -jar slave.jar</em> on the
agent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Windows agent set-up can either follow the standard SSH and JNLP approach  or
use a more Windows-specific configuration approach. Windows agents have the
following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SSH-connector approach with Putty</strong></p>
</li>
<li>
<p><strong>SSH-connector approach with Cygwin and OpenSSH</strong>:
<a href="https://wiki.jenkins.io/display/JENKINS/SSH+slaves+and+Cygwin">This</a> is the
easiest to setup and recommended approach.</p>
</li>
<li>
<p><strong>Remote management facilities (WMI + DCOM)</strong>: With this approach, which
utilizes the
<a href="https://plugins.jenkins.io/windows-slaves">WMI Windows Agents Plugin</a>), the Jenkins master will register the slave agent on the
windows slave machine creating a Windows service. The Jenkins master can
control the slaves, issuing stops/restarts/updates of the same. However this
is difficult to set-up and not recommended.</p>
</li>
<li>
<p><strong>JNLP-connector approach</strong>: With
<a href="https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+as+a+Windows+service">this approach</a>
 it is possible to manually register the slave as Windows service,
but it will not be possible to centrally manage it from the master. Each
stop/start/update of the slave agent needs to be executed manually on the
slave machine, unless running Jenkins 1.611 or newer.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-fungible-slaves"><a class="anchor" href="#creating-fungible-slaves"></a>Creating fungible slaves</h3>
<div class="sect3">
<h4 id="configuring-tools-location-on-slaves"><a class="anchor" href="#configuring-tools-location-on-slaves"></a>Configuring tools location on slaves</h4>
<div class="paragraph">
<p>The Jenkins Global configuration page let you specify the tools needed during
the builds (i.e. Ant, Maven, Java, etc).</p>
</div>
<div class="paragraph">
<p>When defining a tool, it is possible to create a pointer to an existing
installation by giving the directory where the program is expected to be on the
slave. Another option is to let Jenkins take care of the installation of a
specific version in the given location. It is also possible to specify more
than one installation for the same tool since different jobs may need different
versions of the same tool.</p>
</div>
<div class="paragraph">
<p>The pre-compiled "Default" option calls whatever is already installed on the
slave and exists in the machine PATH, but this will return a failure if the
tool was not already installed and its location was not added to the PATH
system variable.</p>
</div>
<div class="paragraph">
<p>One best practice to avoid this failure is to configure a job with the
assumption that the target slave does not have the necessary tools installed,
and to include the tools' installation as part of the build process.</p>
</div>
</div>
<div class="sect3">
<h4 id="define-a-policy-to-share-slave-machines"><a class="anchor" href="#define-a-policy-to-share-slave-machines"></a>Define a policy to share slave machines</h4>
<div class="paragraph">
<p>As mentioned previously, slaves should be interchangeable and standardized in
order to make them sharable and to optimize resource usage.  Slaves should not
be customized for a particular set of jobs, nor for a particular team.</p>
</div>
<div class="paragraph">
<p>Lately Jenkins has become more and more popular not only in CI but also in CD,
which means that it must orchestrate jobs and pipelines which involve different
teams and technical profiles: developers, QA people and Dev-Ops people.</p>
</div>
<div class="paragraph">
<p>In such a scenario, it might make sense to create customized and dedicated
slaves: different tools are usually required by different teams (i.e.
Puppet/Chef for the Ops team) and teams' credentials are usually stored on the
slave in order to ensure their protection and privacy.</p>
</div>
<div class="paragraph">
<p>In order to ensure the execution of a job on a single/group of slaves only
(i.e. iOS builds on OSX slaves only), it is possible to tie the job to the
slave by specifying the slave&#8217;s label in the job configuration page. Note that
the restriction has to be replicated in every single job to be tied and that
the slave won&#8217;t be protected from being used by other teams.</p>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-cloud-slaves"><a class="anchor" href="#setting-up-cloud-slaves"></a>Setting up cloud slaves</h4>
<div class="paragraph">
<p>Cloud build resources can be a solution for a case when it is necessary to
maintain a reasonably small cluster of slaves on-premise while still providing
new build resources when needed.</p>
</div>
<div class="paragraph">
<p>In particular it is possible to offload the execution of the jobs to slaves in
the cloud thanks to ad-hoc plugins which will handle the creation of the cloud
resources together with their destruction when they are not needed anymore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://plugins.jenkins.io/ec2">EC2 Plugin</a>
let Jenkins use AWS EC2 instances as cloud build resources when it runs out
of on-premise slaves. The EC2 slaves will be dynamically created inside an
AWS network and de-provisioned when they are not needed.</p>
</li>
<li>
<p>The <a href="https://plugins.jenkins.io/jclouds-jenkins">JCloud plugin</a>
creates the possibility of executing the jobs on any cloud provider supported
by JCloud libraries</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="right-sizing-jenkins-masters"><a class="anchor" href="#right-sizing-jenkins-masters"></a>Right-sizing Jenkins masters</h3>
<div class="paragraph">
<p>Comprehensive hardware recommendations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hardware: see the <a href="/doc/book/hardware-recommendations/#hardware-recommendations">Hardware Recommendations</a> page</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="master-division-strategies"><a class="anchor" href="#master-division-strategies"></a>Master division strategies</h4>
<div class="paragraph">
<p>Designing the best Jenkins architecture for your organization is dependent on
how you stratify the development of your projects and can be constrained by
limitations of the existing Jenkins plugins.</p>
</div>
<div class="paragraph">
<p>The 3 most common forms of stratifying development by masters is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>By environment (QA, DEV, etc)</strong> - With this strategy, Jenkins masters are populated by jobs based on what environment they are deploying to.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Pros</strong></p>
<div class="ulist">
<ul>
<li>
<p>Can tailor plugins on masters to be specific to that environment&#8217;s needs</p>
</li>
<li>
<p>Can easily restrict access to an environment to only users who will be using that environment</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Cons</strong></p>
<div class="ulist">
<ul>
<li>
<p>Reduces ability to create pipelines</p>
</li>
<li>
<p>No way to visualize the complete flow across masters</p>
</li>
<li>
<p>Outage of a master will block flow of all products</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>By org chart</strong> - This strategy is when masters are assigned to divisions within an organization.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Pros</strong></p>
<div class="ulist">
<ul>
<li>
<p>Can tailor plugins on masters to be specific to that team&#8217;s needs</p>
</li>
<li>
<p>Can easily restrict access to a division&#8217;s projects to only users who are within that division</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Cons</strong></p>
<div class="ulist">
<ul>
<li>
<p>Reduces ability to create cross-division pipelines</p>
</li>
<li>
<p>No way to visualize the complete flow across masters</p>
</li>
<li>
<p>Outage of a master will block flow of all products</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Group masters by product lines</strong> - When a group of products, with on only critical product in each group, gets its own Jenkins masters.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Pros</strong></p>
<div class="ulist">
<ul>
<li>
<p>Entire flows can be visualized because all steps are on one master</p>
</li>
<li>
<p>Reduces the impact of one master&#8217;s downtime on only affects a small subset of products</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Cons</strong></p>
<div class="ulist">
<ul>
<li>
<p>A strategy for restricting permissions must be devised to keep all users from having access to all items on a master.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When evaluating these strategies, it is important to weigh them against the
vertical and horizontal scaling pitfalls discussed in the introduction.</p>
</div>
<div class="paragraph">
<p>Another note is that a smaller number of jobs translates to faster recovery
from failures and more importantly a higher mean time between failures.</p>
</div>
</div>
<div class="sect3">
<h4 id="calculating-how-many-jobs-masters-and-executors-are-needed"><a class="anchor" href="#calculating-how-many-jobs-masters-and-executors-are-needed"></a>Calculating how many jobs, masters, and executors are needed</h4>
<div class="paragraph">
<p>Having the best possible estimate of necessary configurations for a Jenkins
installation allows an organization to get started on the right foot with
Jenkins and reduces the number of configuration iterations needed to achieve an
optimal installation. The challenge for Jenkins architects is that true limit
of vertical scaling on a Jenkins master is constrained by whatever hardware is
in place for the master, as well as harder to quantify pieces like the types of
builds and tests that will be run on the build nodes.</p>
</div>
<div class="paragraph">
<p>There is a way to estimate roughly how many masters, jobs and executors will be
needed based on build needs and number of developers served. These equations
assume that the Jenkins master will have 5 cores with one core per 100 jobs
(500 total jobs/master) and that teams will be divided into groups of 40.</p>
</div>
<div class="paragraph">
<p>If you have information on the actual number of available cores on your planned
master, you can make adjustments to the
"number of masters" equations accordingly.</p>
</div>
<div class="paragraph">
<p>The equation for <strong>estimating the number of masters and executors needed</strong> when
the number of configured jobs is known is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>masters = number of jobs/500
executors = number of jobs * 0.03</code></pre>
</div>
</div>
<div class="paragraph">
<p>The equation for <strong>estimating the maximum number of jobs, masters, and executors
needed</strong> for an organization based on the number of developers is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>number of jobs = number of developers * 3.333
number of masters = number of jobs/500
number of executors = number of jobs * 0.03</code></pre>
</div>
</div>
<div class="paragraph">
<p>These numbers will provide a good starting point for a Jenkins installation,
but adjustments to actual installation size may be needed based on the types of
builds and tests that an installation runs.</p>
</div>
</div>
<div class="sect3">
<h4 id="scalable-storage-for-masters"><a class="anchor" href="#scalable-storage-for-masters"></a>Scalable storage for masters</h4>
<div class="paragraph">
<p>It is also recommended to choose a master with consideration for future growth
in the number of plugins or jobs stored in your master&#8217;s <em>$JENKINS_HOME</em>.
Storage is cheap and Jenkins does not require fast disk access to run well, so
it is more advantageous to invest in a larger machine for your master over a
faster one.</p>
</div>
<div class="paragraph">
<p>Different operating systems for the Jenkins master will also allow for
different approaches to expandable storage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Spanned Volumes on Windows</strong> - On NTFS devices like Windows, you can create a
spanned volume that allows you to add new volumes to an existing one, but
have them behave as a single volume. To do this, you will have to ensure that
Jenkins is installed on a separate partition so that it can be converted to a
spanned volume later.</p>
</li>
<li>
<p><strong>Logical Volume Manager for Linux</strong> - LVM manages disk drives and allows
logical volumes to be resized on the fly. Many distributions of Linux use LVM
when they are installed, but Jenkins should have its our LVM setup.</p>
</li>
<li>
<p><strong>ZFS for Solaris</strong> - ZFS is even more flexible than LVM and spanned volumes
and just requires that the <em>$JENKINS_HOME</em> be on its own filesystem. This
makes it easier to create snapshots, backups, etc.</p>
</li>
<li>
<p><strong>Symbolic Links</strong> - For systems with existing Jenkins installations and who
cannot use any of the above-mentioned methods, symbolic links (symlinks) may
be used instead to store job folders on separate volumes with symlinks to
those directories.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, to easily prevent a <em>$JENKINS_HOME</em> folder from becoming bloated,
make it mandatory for jobs to discard build records after a specific time
period has passed and/or after a specific number of builds have been run. This
policy can be set on a job&#8217;s configuration page.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-a-backup-policy"><a class="anchor" href="#setting-up-a-backup-policy"></a>Setting up a backup policy</h3>
<div class="paragraph">
<p>It is a best practice to take regular backups of your $JENKINS_HOME. A backup
ensures that your Jenkins instance can be restored despite a misconfiguration,
accidental job deletion, or data corruption.</p>
</div>
<div class="sect3">
<h4 id="finding-your-jenkins_home"><a class="anchor" href="#finding-your-jenkins_home"></a>Finding your $JENKINS_HOME</h4>
<div class="paragraph">
<p><strong>Windows</strong></p>
</div>
<div class="paragraph">
<p>If you install Jenkins with the Windows installer, Jenkins will be installed as
a service and the default <em>$JENKINS_HOME</em> will be "C:\Program Files
(x86)\jenkins".</p>
</div>
<div class="paragraph">
<p>You can edit the location of your <em>$JENKINS_HOME</em> by opening the jenkins.xml
file and editing the <em>$JENKINS_HOME</em> variable, or going to the "Manage Jenkins"
screen, clicking on the "Install as Windows Service" option in the menu, and
then editing the "Installation Directory" field to point to another existing
directory.</p>
</div>
<div class="paragraph">
<p><strong>Mac OSX</strong></p>
</div>
<div class="paragraph">
<p>If you install Jenkins with the OS X installer, you can find and edit the
location of your <em>$JENKINS_HOME</em> by editing the "Macintosh
HD/Library/LaunchDaemons" file&#8217;s <em>$JENKINS_HOME</em> property.</p>
</div>
<div class="paragraph">
<p>By default, the <em>$JENKINS_HOME</em> will be set to "Macintosh
HD/Users/Shared/Jenkins".</p>
</div>
<div class="paragraph">
<p><strong>Ubuntu/Debian</strong></p>
</div>
<div class="paragraph">
<p>If you install Jenkins using a Debian package, you can find and edit the
location of your <em>$JENKINS_HOME</em> by editing your "/etc/default/jenkins" file.</p>
</div>
<div class="paragraph">
<p>By default, the <em>$JENKINS_HOME</em> will set to "/var/lib/jenkins" and your
$JENKINS_WAR will point to "/usr/share/jenkins/jenkins.war".</p>
</div>
<div class="paragraph">
<p><strong>Red Hat/CentOS/Fedora</strong></p>
</div>
<div class="paragraph">
<p>If you install Jenkins as a RPM package, the default <em>$JENKINS_HOME</em> will be
"/var/lib/jenkins".</p>
</div>
<div class="paragraph">
<p>You can edit the location of your <em>$JENKINS_HOME</em> by editing the
"/etc/sysconfig/jenkins" file.</p>
</div>
<div class="paragraph">
<p><strong>openSUSE</strong></p>
</div>
<div class="paragraph">
<p>If installing Jenkins as a package using zypper, you&#8217;ll be able to edit the
<em>$JENKINS_HOME</em> by editing the "/etc/sysconfig/jenkins" file.</p>
</div>
<div class="paragraph">
<p>The default location for your <em>$JENKINS_HOME</em> will be set to "/var/lib/jenkins"
and the $JENKINS_WAR home will be in "/usr/lib/jenkins".</p>
</div>
<div class="paragraph">
<p><strong>FreeBSD</strong></p>
</div>
<div class="paragraph">
<p>If installing Jenkins using a port, the <em>$JENKINS_HOME</em> will be located in
whichever directory you run the "make" command in. It is recommended to create
a "/usr/ports/devel/jenkins" folder and compile Jenkins in that directory.</p>
</div>
<div class="paragraph">
<p>You will be able to edit the <em>$JENKINS_HOME</em> by editing the
"/usr/local/etc/jenkins".</p>
</div>
<div class="paragraph">
<p><strong>OpenBSD</strong></p>
</div>
<div class="paragraph">
<p>If installing Jenkins using a package,the <em>$JENKINS_HOME</em> is set by default to
"/var/jenkins".</p>
</div>
<div class="paragraph">
<p>If installing Jenkins using a port, the <em>$JENKINS_HOME</em> will be located in
whichever directory you run the "make" command in. It is recommended to create
a "/usr/ports/devel/jenkins" folder and compile Jenkins in that directory.</p>
</div>
<div class="paragraph">
<p>You will be able to edit the <em>$JENKINS_HOME</em> by editing the
"/usr/local/etc/jenkins" file.</p>
</div>
<div class="paragraph">
<p><strong>Solaris/OpenIndiana</strong></p>
</div>
<div class="paragraph">
<p>The Jenkins project voted on September 17, 2014 to discontinue Solaris
packages.</p>
</div>
</div>
<div class="sect3">
<h4 id="anatomy-of-a-jenkins_home"><a class="anchor" href="#anatomy-of-a-jenkins_home"></a>Anatomy of a $JENKINS_HOME</h4>
<div class="paragraph">
<p>The folder structure for a <em>$JENKINS_HOME</em> directory is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>JENKINS_HOME
 +- config.xml     (Jenkins root configuration file)
 +- *.xml          (other site-wide configuration files)
 +- identity.key   (RSA key pair that identifies an instance)
 +- secret.key     (deprecated key used for some plugins' secure operations)
 +- secret.key.not-so-secret  (used for validating _$JENKINS_HOME_ creation date)
 +- userContent    (files served under your https://server/userContent/)
 +- secrets        (root directory for the secret+key for credential decryption)
     +- hudson.util.Secret   (used for encrypting some Jenkins data)
     +- master.key           (used for encrypting the hudson.util.Secret key)
     +- InstanceIdentity.KEY (used to identity this instance)
 +- fingerprints   (stores fingerprint records, if any)
 +- plugins        (root directory for all Jenkins plugins)
     +- [PLUGINNAME]   (sub directory for each plugin)
         +- META-INF       (subdirectory for plugin manifest + pom.xml)
         +- WEB-INF        (subdirectory for plugin jar(s) and licenses.xml)
     +- [PLUGINNAME].jpi   (.jpi or .hpi file for the plugin)
 +- jobs           (root directory for all Jenkins jobs)
     +- [JOBNAME]      (sub directory for each job)
         +- config.xml     (job configuration file)
         +- workspace      (working directory for the version control system)
         +- latest         (symbolic link to the last successful build)
         +- builds         (stores past build records)
             +- [BUILD_ID]     (subdirectory for each build)
                 +- build.xml      (build result summary)
                 +- log            (log file)
                 +- changelog.xml  (change log)
     +- [FOLDERNAME]   (sub directory for each folder)
         +- config.xml     (folder configuration file)
         +- jobs           (sub directory for all nested jobs)</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="segrate-data"><a class="anchor" href="#segrate-data"></a>Segregating pure configuration from less durable data</h5>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
No data migration is handled by Jenkins when using those settings.
So you either want to use them from the beginning, or make sure you take into consideration which data you would like to be moved to the right place before using the following switches.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to separate customize some of the layout to better separate pure job configurations from less durable data, like build data or logs.
<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
<div class="sect5">
<h6 id="configure-a-different-jobs-build-data-layout"><a class="anchor" href="#configure-a-different-jobs-build-data-layout"></a>Configure a different <em>jobs build data</em> layout</h6>
<div class="paragraph">
<p>Historically, the configuration of a given job is located under <code>$JENKINS_HOME/jobs/[JOB_NAME]/config.xml</code> and its builds are under <code>$JENKINS_HOME/jobs/[JOB_NAME]/builds</code>.</p>
</div>
<div class="paragraph">
<p>This typically makes it more impractical to set up a different backup policy, or set up a quicker disk for making builds potentially faster.</p>
</div>
<div class="paragraph">
<p>For instance, if you would like to move builds under a different root, you can use the following value: <code>$JENKINS_VAR/${ITEM_FULL_NAME}/builds</code>.</p>
</div>
<div class="paragraph">
<p>Note that starting with Jenkins 2.119, the User Interface for this was replaced by the <code>jenkins.model.Jenkins.buildsDir</code> system property. See the <a href="https://wiki.jenkins.io/display/JENKINS/Features+controlled+by+system+properties">dedicated <em>Features Controlled with System Properties</em> wiki page</a> for more details.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="choosing-a-backup-strategy"><a class="anchor" href="#choosing-a-backup-strategy"></a>Choosing a backup strategy</h4>
<div class="paragraph">
<p>All of your Jenkins-specific configurations that need to be backed up will live
in the <em>$JENKINS_HOME</em>, but it is a best practice to back up only a subset of
those files and folders.</p>
</div>
<div class="paragraph">
<p>Below are a few guidelines to consider when planning your backup strategy.</p>
</div>
<div class="paragraph">
<div class="title">Exclusions</div>
<p>When it comes to creating a backup, it is recommended to exclude archiving the
following folders to reduce the size of your backup:</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap">/war      (the exploded Jenkins war directory)
/cache    (downloaded tools)
/tools    (extracted tools)</pre>
</div>
</div>
<div class="paragraph">
<p>These folders will automatically be recreated the next time a build runs or
Jenkins is launched.</p>
</div>
<div class="paragraph">
<div class="title">Jobs and Folders</div>
<p>Your job or folder configurations, build histories, archived artifacts, and
workspace will exist entirely within the <em>jobs</em> folder.</p>
</div>
<div class="paragraph">
<p>The <em>jobs</em> directory, whether nested within a folder or at the root level is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code> +- jobs           (root directory for all Jenkins jobs)
     +- [JOBNAME]      (sub directory for each job)
         +- config.xml     (job configuration file)
         +- workspace      (working directory for the version control system)
         +- latest         (symbolic link to the last successful build)
         +- builds         (stores past build records)
             +- [BUILD_ID]     (subdirectory for each build)
                 +- build.xml      (build result summary)
                 +- log            (log file)
                 +- changelog.xml  (change log)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you only need to backup your job configurations, you can opt to only backup
the <em>config.xml</em> for each job. Generally build records and workspaces do not
need to be backed up, as workspaces will be re-created when a job is run and
build records are only as important as your organizations deems them.</p>
</div>
<div class="paragraph">
<div class="title">System configurations</div>
<p>Your instance&#8217;s system configurations exist in the root level of the
<em>$JENKINS_HOME</em> folder:</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap"> +- config.xml     (Jenkins root configuration file)
 +- *.xml          (other site-wide configuration files)</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>config.xml</em> is the root configuration file for your Jenkins. It includes
configurations for the paths of installed tools, workspace directory, and slave
agent port.</p>
</div>
<div class="paragraph">
<p>Any .xml other than that <em>config.xml</em> in the root Jenkins folder is a global
configuration file for an installed tool or plugin (i.e. Maven, Git, Ant, etc).
This includes the <em>credentials.xml</em> if the Credentials plugin is installed.</p>
</div>
<div class="paragraph">
<p>If you only want to backup your core Jenkins configuration, you only need to
back up the <em>config.xml</em>.</p>
</div>
<div class="paragraph">
<div class="title">Plugins</div>
<p>Your instance&#8217;s plugin files (.hpi and .jpi) and any of their dependent
resources (help files, <em>pom.xml</em> files, etc) will exist in the <em>plugins</em> folder
in $JENKINS_HOME.</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap"> +- plugins        (root directory for all Jenkins plugins)
     +- [PLUGINNAME]     (sub directory for each plugin)
         +- META-INF       (subdirectory for plugin manifest + pom.xml)
         +- WEB-INF        (subdirectory for plugin jar(s) and licenses.xml)
     +- [PLUGINNAME].jpi (.jpi or .hpi file for the plugin)</pre>
</div>
</div>
<div class="paragraph">
<p>It is recommended to back up the entirety of the plugins folder (.hpi/.jpis + folders).</p>
</div>
<div class="paragraph">
<div class="title">Other data</div>
<p>Other data that you are recommended to back up include the contents of your
<em>secrets</em> folder, your <em>identity.key</em>, your <em>secret.key</em>, and your
<em>secret.key.not-so-secret</em> file.</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap">+- identity.key   (RSA key pair that identifies an instance)
 +- secret.key     (used for various secure Jenkins operations)
 +- secret.key.not-so-secret  (used for validating _$JENKINS_HOME_ creation date)
 +- userContent    (files served in https://server/userContent/)
 +- secrets        (directory for the secret+key decryption)
     +- hudson.util.Secret   (used for encrypting some Jenkins data)
     +- master.key           (used for encrypting the hudson.util.Secret key)
     +- InstanceIdentity.KEY (used to identity this instance)</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>identity.key</em> is an RSA key pair that identifies and authenticates the
current Jenkins instance.</p>
</div>
<div class="paragraph">
<p>The <em>secret.key</em> is used to encrypt plugin and other Jenkins data, and to
establish a secure connection between a master and slave.</p>
</div>
<div class="paragraph">
<p>The <em>secret.key.not-so-secret</em> file is used to validate when the
<em>$JENKINS_HOME</em> was created. It is also meant to be a flag that the secret.key
file is a deprecated way of encrypting information.</p>
</div>
<div class="paragraph">
<p>The files in the secrets folder are used by Jenkins to encrypt and decrypt your
instance&#8217;s stored credentials, if any exist. Loss of these files will prevent
recovery of any stored credentials. <em>hudson.util.Secret</em> is used for encrypting
some Jenkins data like the credentials.xml, while the <em>master.key</em> is used for
encrypting the hudson.util.Secret key. Finally, the <em>InstanceIdentity.KEY</em> is
used to identity this instance and for producing digital signatures.</p>
</div>
</div>
<div class="sect3">
<h4 id="define-a-jenkins-instance-to-rollback-to"><a class="anchor" href="#define-a-jenkins-instance-to-rollback-to"></a>Define a Jenkins instance to rollback to</h4>
<div class="paragraph">
<p>In the case of a total machine failure, it is important to ensure that there is
a plan in place to get Jenkins both back online and in its last good state.</p>
</div>
<div class="paragraph">
<p>If a high availability set up has not been enabled and no back up of that
master&#8217;s filesystem has been taken, then an corruption of a machine running
Jenkins means that all historical build data and artifacts, job and system
configurations, etc. will be lost and the lost configurations will need to be
recreated on a new instance.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Backup policy - In addition to creating backups using the previous section&#8217;s
backup guide, it is important to establish a policy for selecting which backup
should be used when restoring a downed master.</p>
</li>
<li>
<p>Restoring from a backup - A plan must be put in place on whether the backup
should be restored manually or with scripts when the primary goes down.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resilient-jenkins-architecture"><a class="anchor" href="#resilient-jenkins-architecture"></a>Resilient Jenkins Architecture</h3>
<div class="paragraph">
<p>Administrators are constantly adding more and more teams to the software
factory, making administrators in the business of making their instances
resilient to failures and scaling them in order to onboard more teams.</p>
</div>
<div class="paragraph">
<p>Adding build nodes to a Jenkins instance while beefing up the machine that runs
the Jenkins master is the typical way to scale Jenkins. Said differently,
administrators scale their Jenkins master vertically. However, there is a limit
to how much an instance can be scaled. These limitations are covered in the
introduction to this chapter.</p>
</div>
<div class="paragraph">
<p>Ideally, masters will be set up to automatically recover from failures without
human intervention. There are proxy servers monitoring active masters and
re-routing requests to backup masters if the active master goes down. There are
additional factors that should be reviewed on the path to continuous delivery.
These factors include componetizing the application under development,
automating the entire pipeline (within reasonable limits) and freeing up
contentious resources.</p>
</div>
<div class="paragraph">
<div class="title">Step 1: Make each master highly available</div>
<p>Each Jenkins master needs to be set up such that it is part of a Jenkins cluster.</p>
</div>
<div class="paragraph">
<p>A proxy (typically HAProxy or F5) then fronts the primary master. The proxy&#8217;s
job is to continuously monitor the primary master and route requests to the
backup if the primary goes down. To make the infrastructure more resilient, you
can have multiple backup masters configured.</p>
</div>
<div class="paragraph">
<div class="title">Step 2: Enable security</div>
<p>Set up an authentication realm that Jenkins will use for its user database.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are trying to set up a proof-of-concept, it is recommended to use
the <a href="https://plugins.jenkins.io/mock-security-realm">Mock Security Realm plugin</a> for authentication.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Step 3: Add build nodes (slaves) to master</div>
<p>Add build servers to your master to ensure you are conducting actual build
execution off of the master, which is meant to be an orchestration hub, and
onto a "dumb" machine with sufficient memory and I/O for a given job or test.</p>
</div>
<div class="paragraph">
<div class="title">Step 4: Setup a test instance</div>
<p>A test instance is typically used to test new plugin updates. When a plugin is
ready to be used, it should be installed into the main production update
center.</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. These switches are used to configure out of the box <a href="https://jenkins.io/blog/2018/04/06/jenkins-essentials/">Jenkins Essentials</a> instances.
</div>
</div>
</div>
</div>
</div>


<script src="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/anchor-js/anchor.min.js"></script>
<script src="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/tether/js/tether.min.js"></script>
<script src="https://zbynek.github.io/jenkins.io/order-syntax/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<footer id="footer">
<div class="container">
<div class="row">
<div class="col-md-4">
<p class="box">
<a href="https://github.com/jenkins-infra/jenkins.io/edit/master/content//doc/book/architecting-for-scale.adoc" title="Edit /doc/book/architecting-for-scale.adoc on GitHub">Improve this page</a>
|
<a href="https://github.com/jenkins-infra/jenkins.io/commits/master/content//doc/book/architecting-for-scale.adoc" title="View /doc/book/architecting-for-scale.adoc history on GitHub">Page history</a>
</p>
<div class="license-box">
<div id="creativecommons">
<a href="https://creativecommons.org/licenses/by-sa/4.0/">
<p>
<img alt="Creative Commons Attribution-ShareAlike license" src="https://licensebuttons.net/l/by-sa/4.0/88x31.png">
</p>
</a>
<p>
The content driving this site is licensed under the Creative
Commons Attribution-ShareAlike 4.0 license.
</p>
</div>
</div>
</div>
<div class="links col-md-8">
<div class="container">
<div class="row">
<div class="area col-md-3">
<div class="div-mar">
<h5>Resources</h5>
<ul class="resources">
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/download">
Downloads
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/node">
Blog
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/doc">
Documentation
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/">
Plugins
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/security">
Security
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/participate">
Contributing
</a>
</li>
</ul>
</div>
</div>
<div class="area col-md-3">
<div class="div-mar">
<h5>Project</h5>
<ul class="project">
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/project">
Structure and governance
</a>
</li>
<li>
<a href="https://issues.jenkins-ci.org">
Issue tracker
</a>
</li>
<li>
<a href="https://wiki.jenkins.io">
Wiki
</a>
</li>
<li>
<a href="https://github.com/jenkinsci">
GitHub
</a>
</li>
<li>
<a href="https://ci.jenkins.io">
Jenkins on Jenkins
</a>
</li>
</ul>
</div>
</div>
<div class="area col-md-3">
<div class="div-mar">
<h5>Community</h5>
<ul class="community">
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/events">
Events
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/mailing-lists">
Mailing lists
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/chat">
Chats
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/sigs">
Special Interest Groups
</a>
</li>
<li>
<a href="https://twitter.com/jenkinsci">
Twitter
</a>
</li>
<li>
<a href="https://reddit.com/r/jenkinsci">
Reddit
</a>
</li>
</ul>
</div>
</div>
<div class="area col-md-3">
<div class="div-mar">
<h5>Other</h5>
<ul class="other">
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/conduct">
Code of Conduct
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/press">
Press information
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/merchandise">
Merchandise
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/artwork">
Artwork
</a>
</li>
<li>
<a href="https://zbynek.github.io/jenkins.io/order-syntax/awards">
Awards
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  !function(d,s,id) {
    var js, fjs=d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
      js = d.createElement(s);
      js.id=id;
      js.src="//platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js,fjs);
    }
  }(document,"script","twitter-wjs");
  
  $(function(){
    var $body = $(document.body);
    $(".nav-link.dropdown-toggle").on("mousedown", function(){
      $body.addClass("no-outline");
    })
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
</body>
</html>
